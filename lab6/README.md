# Лабораторная работа №6 - Шифр RSA

## Описание алгоритма

RSA - это асимметричный криптографический алгоритм, основанный на сложности факторизации больших чисел. Он использует два простых числа `p` и `q`, из которых формируются открытый и секретный ключи.

### Принцип работы

1. **Генерация ключей**:
   - Выбираются два различных простых числа `p` и `q`
   - Вычисляется `n = p * q` (модуль)
   - Вычисляется `φ(n) = (p-1) * (q-1)` (функция Эйлера)
   - Выбирается открытый ключ `e` (взаимно простое с φ(n))
   - Вычисляется секретный ключ `d` (обратный к e по модулю φ(n))

2. **Шифрование**: `C = M^e mod n`
3. **Расшифровка**: `M = C^d mod n`

### Математические формулы

- `n = p * q` (модуль)
- `φ(n) = (p-1) * (q-1)` (функция Эйлера)
- `e * d ≡ 1 (mod φ(n))` (связь ключей)
- `C = M^e mod n` (шифрование)
- `M = C^d mod n` (расшифровка)

## Пример работы алгоритма

### Простой пример

```python
# Параметры
p = 3          # первое простое число
q = 11         # второе простое число
M = 4          # сообщение

# Вычисляем ключи
n = 3 * 11 = 33
φ(n) = (3-1) * (11-1) = 2 * 10 = 20
e = 3          # открытый ключ (взаимно простое с 20)
d = 7          # секретный ключ (3 * 7 = 21 ≡ 1 mod 20)

# Шифрование
C = 4^3 mod 33 = 64 mod 33 = 31

# Расшифровка
M_decrypted = 31^7 mod 33 = 27512614111 mod 33 = 4
```

### Реальный пример с большими числами

```python
# Параметры
p = 1000000007  # первое простое число
q = 1000000009  # второе простое число
M = 12345       # сообщение

# Вычисляем ключи
n = 1000000007 * 1000000009 = 1000000016000000063
φ(n) = (1000000007-1) * (1000000009-1) = 1000000006 * 1000000008
e = 65537       # открытый ключ
d = e^(-1) mod φ(n)  # секретный ключ

# Шифрование
C = 12345^65537 mod n

# Расшифровка
M_decrypted = C^d mod n
```

## Запуск программы

```bash
# Демонстрация
python lab6.py --mode demo

# Шифрование файла
python lab6.py --mode encrypt --input file.txt --output encrypted.txt

# Расшифровка файла
python lab6.py --mode decrypt --input encrypted.txt --output decrypted.txt
```

## Особенности реализации

- Автоматическая генерация простых чисел
- Проверка взаимной простоты ключей
- Каждый байт файла шифруется отдельно
- Поддержка больших чисел
- Использование быстрого возведения в степень
