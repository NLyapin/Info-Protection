# Лабораторная работа №4 - Шифр Шамира

## Описание алгоритма

Шифр Шамира - это криптографический алгоритм, основанный на проблеме дискретного логарифма. Он использует три ключа: простое число `p` и два секретных ключа `C1`, `C2`.

### Принцип работы

1. **Шифрование**: Сообщение `M` шифруется в два этапа:
   - `x1 = M^C1 mod p`
   - `x2 = x1^C2 mod p`

2. **Расшифровка**: Зашифрованное сообщение расшифровывается в обратном порядке:
   - `y1 = x2^D2 mod p`
   - `M = y1^D1 mod p`

Где `D1` и `D2` - обратные элементы к `C1` и `C2` по модулю `p-1`.

### Математические формулы

- `C1 * D1 ≡ 1 (mod p-1)`
- `C2 * D2 ≡ 1 (mod p-1)`

## Пример работы алгоритма

### Простой пример

```python
# Параметры
p = 7          # простое число
C1 = 3         # первый секретный ключ
C2 = 5         # второй секретный ключ
M = 4          # сообщение для шифрования

# Вычисляем обратные элементы
# C1 * D1 ≡ 1 (mod 6) => 3 * D1 ≡ 1 (mod 6) => D1 = 5
# C2 * D2 ≡ 1 (mod 6) => 5 * D2 ≡ 1 (mod 6) => D2 = 5

# Шифрование
x1 = 4^3 mod 7 = 64 mod 7 = 1
x2 = 1^5 mod 7 = 1 mod 7 = 1

# Расшифровка
y1 = 1^5 mod 7 = 1 mod 7 = 1
M_decrypted = 1^5 mod 7 = 1 mod 7 = 1
```

### Реальный пример с большими числами

```python
# Параметры
p = 1000000007  # большое простое число
C1 = 123456789  # первый секретный ключ
C2 = 987654321  # второй секретный ключ
M = 12345       # сообщение

# Шифрование
x1 = 12345^123456789 mod 1000000007
x2 = x1^987654321 mod 1000000007

# Расшифровка (используя обратные элементы)
y1 = x2^D2 mod 1000000007
M_decrypted = y1^D1 mod 1000000007
```

## Запуск программы

```bash
# Демонстрация
python lab4.py --mode demo

# Шифрование файла
python lab4.py --mode encrypt --input file.txt --output encrypted.txt

# Расшифровка файла
python lab4.py --mode decrypt --input encrypted.txt --output decrypted.txt
```

## Особенности реализации

- Каждый байт файла шифруется отдельно
- Поддержка больших чисел (до 10! и больше)
- Автоматическая генерация ключей
- Проверка корректности параметров
